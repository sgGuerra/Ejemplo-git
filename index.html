<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Buscador Reactivo ULTRA SIMPLE</title>
    <style>
        body { 
            font-family: Arial, sans-serif; 
            max-width: 600px; 
            margin: 50px auto; 
            padding: 20px; 
            background: #f0f8ff;
        }
        
        h1 { 
            text-align: center; 
            color: #2c3e50;
            margin-bottom: 30px;
        }
        
        input { 
            width: 100%; 
            padding: 15px; 
            font-size: 16px; 
            border: 2px solid #3498db; 
            border-radius: 8px;
            margin-bottom: 20px;
        }
        
        .concept-section {
            background: white;
            border-left: 4px solid #e74c3c;
            padding: 15px;
            margin: 15px 0;
            border-radius: 5px;
        }
        
        .concept-title {
            font-weight: bold;
            color: #e74c3c;
            font-size: 14px;
            margin-bottom: 8px;
        }
        
        .code-highlight {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            padding: 10px;
            border-radius: 4px;
            font-family: monospace;
            margin: 5px 0;
            font-size: 12px;
        }
        
        .debug {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            padding: 10px;
            border-radius: 5px;
            margin: 10px 0;
            font-size: 13px;
        }
        
        .suggestion {
            background: white;
            padding: 10px;
            margin: 5px 0;
            border: 1px solid #ddd;
            border-radius: 4px;
            cursor: pointer;
        }
        
        .suggestion:hover {
            background: #e3f2fd;
        }
        
        .no-results {
            text-align: center;
            color: #666;
            padding: 20px;
            font-style: italic;
        }
    </style>
</head>
<body>
    <h1>ğŸ” Buscador Reactivo ULTRA SIMPLE</h1>
    <p style="text-align: center; color: #666;">VersiÃ³n mÃ­nima para entender Observables, Observers y Pipes</p>
    
    <!-- INPUT DE BÃšSQUEDA -->
    <input type="text" id="searchInput" placeholder="Escribe algo... (ej: java, python, react)">
    
    <!-- SECCIÃ“N 1: OBSERVABLE -->
    <div class="concept-section">
        <div class="concept-title">ğŸ“¡ 1. OBSERVABLE (LÃ­neas 80-95)</div>
        <p>Observa los cambios en el input y los convierte en un "stream" de datos</p>
        <div class="code-highlight">
            fromEvent(input, 'input') // â† Este es el OBSERVABLE
        </div>
        <div id="observable-debug" class="debug">Esperando eventos del input...</div>
    </div>
    
    <!-- SECCIÃ“N 2: PIPES/OPERADORES -->
    <div class="concept-section">
        <div class="concept-title">ğŸ”§ 2. PIPES/OPERADORES (LÃ­neas 100-110)</div>
        <p>Transforman y filtran los datos que fluyen por el stream</p>
        <div class="code-highlight">
            .pipe(<br>
            &nbsp;&nbsp;debounceTime(300), // â† PIPE 1: Espera 300ms<br>
            &nbsp;&nbsp;filter(...),      // â† PIPE 2: Filtra texto corto<br>
            &nbsp;&nbsp;map(...)          // â† PIPE 3: Busca sugerencias<br>
            )
        </div>
        <div id="pipes-debug" class="debug">Pipes inactivos...</div>
    </div>
    
    <!-- SECCIÃ“N 3: OBSERVER -->
    <div class="concept-section">
        <div class="concept-title">ğŸ‘ï¸ 3. OBSERVER (LÃ­neas 115-125)</div>
        <p>Recibe los datos finales y actualiza la interfaz</p>
        <div class="code-highlight">
            .subscribe({ // â† Este es el OBSERVER<br>
            &nbsp;&nbsp;next: (data) => mostrarResultados(data)<br>
            })
        </div>
        <div id="observer-debug" class="debug">Observer esperando datos...</div>
    </div>
    
    <!-- RESULTADOS -->
    <div id="results">
        <div class="no-results">ğŸ’¡ Empieza a escribir para ver la magia reactiva</div>
    </div>

    <!-- RXJS desde CDN -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/rxjs/7.8.1/rxjs.umd.min.js"></script>
    
    <script>
        // ============================================
        // ğŸ“Š DATOS DE EJEMPLO (sÃºper simple)
        // ============================================
        const datos = [
            'JavaScript',
            'Java',
            'Python', 
            'React',
            'Vue.js',
            'Angular',
            'Node.js',
            'HTML',
            'CSS'
        ];
        
        // Referencias a elementos HTML
        const input = document.getElementById('searchInput');
        const observableDebug = document.getElementById('observable-debug');
        const pipesDebug = document.getElementById('pipes-debug');
        const observerDebug = document.getElementById('observer-debug');
        const results = document.getElementById('results');
        
        // ============================================
        // ğŸ“¡ PASO 1: CREAR OBSERVABLE
        // ============================================
        console.log('ğŸš€ PASO 1: Creando Observable...');
        
        // â­ AQUÃ ESTÃ EL OBSERVABLE â­
        const inputObservable = rxjs.fromEvent(input, 'input');
        
        // Debug: mostrar cuando el Observable emite
        inputObservable.subscribe(event => {
            const valor = event.target.value;
            observableDebug.innerHTML = `âœ… Observable emitiÃ³: "<strong>${valor}</strong>"`;
            console.log('ğŸ“¡ Observable emitiÃ³:', valor);
        });
        
        // ============================================
        // ğŸ”§ PASO 2: AGREGAR PIPES/OPERADORES
        // ============================================
        console.log('ğŸš€ PASO 2: Agregando Pipes...');
        
        // â­ AQUÃ ESTÃN LAS PIPES â­
        const searchStream = inputObservable.pipe(
            // PIPE 1: Obtener solo el texto del input
            rxjs.operators.map(event => {
                const texto = event.target.value;
                pipesDebug.innerHTML = `ğŸ”§ Pipe MAP: Extrajo texto "<strong>${texto}</strong>"`;
                return texto;
            }),
            
            // PIPE 2: Esperar 300ms despuÃ©s del Ãºltimo carÃ¡cter
            rxjs.operators.debounceTime(300),
            rxjs.operators.tap(texto => {
                pipesDebug.innerHTML += `<br>â° Pipe DEBOUNCE: EsperÃ³ 300ms, procesando "<strong>${texto}</strong>"`;
            }),
            
            // PIPE 3: Solo procesar si hay al menos 2 caracteres
            rxjs.operators.filter(texto => {
                const esValido = texto.length >= 2;
                if (esValido) {
                    pipesDebug.innerHTML += `<br>âœ… Pipe FILTER: Texto vÃ¡lido (${texto.length} chars)`;
                } else {
                    pipesDebug.innerHTML += `<br>âŒ Pipe FILTER: Texto muy corto (${texto.length} chars)`;
                    results.innerHTML = '<div class="no-results">ğŸ’¡ Escribe al menos 2 caracteres</div>';
                }
                return esValido;
            }),
            
            // PIPE 4: Buscar sugerencias
            rxjs.operators.map(texto => {
                const sugerencias = buscarSugerencias(texto);
                pipesDebug.innerHTML += `<br>ğŸ” Pipe BÃšSQUEDA: EncontrÃ³ ${sugerencias.length} sugerencias`;
                return sugerencias;
            })
        );
        
        // ============================================
        // ğŸ‘ï¸ PASO 3: CREAR OBSERVER
        // ============================================
        console.log('ğŸš€ PASO 3: Creando Observer...');
        
        // â­ AQUÃ ESTÃ EL OBSERVER â­
        const observer = {
            next: (sugerencias) => {
                observerDebug.innerHTML = `ğŸ‘ï¸ Observer recibiÃ³ ${sugerencias.length} sugerencias`;
                console.log('ğŸ‘ï¸ Observer recibiÃ³:', sugerencias);
                mostrarSugerencias(sugerencias);
            },
            error: (error) => {
                observerDebug.innerHTML = `âŒ Observer recibiÃ³ error: ${error}`;
                console.error('ğŸ’¥ Error:', error);
            },
            complete: () => {
                observerDebug.innerHTML = `âœ… Observer completado`;
                console.log('ğŸ Stream completado');
            }
        };
        
        // ============================================
        // ğŸ”— PASO 4: CONECTAR TODO (SUSCRIPCIÃ“N)
        // ============================================
        console.log('ğŸš€ PASO 4: Conectando Observable con Observer...');
        
        // â­ AQUÃ SE CONECTA TODO â­
        const subscription = searchStream.subscribe(observer);
        
        console.log('âœ… Â¡Buscador reactivo listo!');
        console.log('ğŸ”„ Flujo: Input â†’ Observable â†’ Pipes â†’ Observer â†’ UI');
        
        // ============================================
        // ğŸ” FUNCIONES AUXILIARES
        // ============================================
        
        /**
         * Busca sugerencias en los datos
         */
        function buscarSugerencias(texto) {
            const textoMinuscula = texto.toLowerCase();
            return datos.filter(item => 
                item.toLowerCase().includes(textoMinuscula)
            );
        }
        
        /**
         * Muestra las sugerencias en la interfaz
         */
        function mostrarSugerencias(sugerencias) {
            if (sugerencias.length === 0) {
                results.innerHTML = '<div class="no-results">ğŸ” No se encontraron resultados</div>';
                return;
            }
            
            const html = sugerencias
                .map(sugerencia => `
                    <div class="suggestion" onclick="seleccionar('${sugerencia}')">
                        ${sugerencia}
                    </div>
                `)
                .join('');
            
            results.innerHTML = html;
        }
        
        /**
         * Selecciona una sugerencia
         */
        function seleccionar(sugerencia) {
            input.value = sugerencia;
            alert(`âœ… Seleccionaste: ${sugerencia}`);
        }
        
        // ============================================
        // ğŸ“‹ RESUMEN FINAL
        // ============================================
        console.log('');
        console.log('ğŸ“š RESUMEN DE CONCEPTOS:');
        console.log('ğŸ“¡ Observable (lÃ­nea 85): fromEvent(input, "input")');
        console.log('ğŸ”§ Pipes (lÃ­neas 95-115): map, debounceTime, filter, map');
        console.log('ğŸ‘ï¸ Observer (lÃ­neas 120-130): objeto con next, error, complete');
        console.log('ğŸ”— SuscripciÃ³n (lÃ­nea 135): searchStream.subscribe(observer)');
        console.log('');
        console.log('ğŸ”„ FLUJO DE DATOS:');
        console.log('1. Usuario escribe â†’ Observable emite evento');
        console.log('2. Pipes transforman: evento â†’ texto â†’ filtrado â†’ sugerencias');
        console.log('3. Observer recibe sugerencias â†’ actualiza interfaz');
        console.log('');
        console.log('Â¡Empieza a escribir para verlo en acciÃ³n! ğŸš€');
    </script>
</body>
</html>